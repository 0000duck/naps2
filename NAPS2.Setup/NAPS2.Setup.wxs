<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product
      Id="*"
      Name="NAPS2"
      Language="1033"
      Version="3.1"
      Manufacturer="Ben Olden-Cooligan"
      UpgradeCode="FEB82971-B3E6-4F19-9684-1D543E644D73">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <Media Id="1" Cabinet="NAPS2.cab" EmbedCab="yes" CompressionLevel="medium" />

    <Icon Id="icon.ico" SourceFile="..\NAPS2.Core\Resources\scanner.ico"/>
    <Property Id="ARPPRODUCTICON" Value="icon.ico" />
    
    <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." />

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <UIRef Id="WixUI_InstallDir" />
    <WixVariable Id="WixUILicenseRtf" Value="..\NAPS2\Setup\license.rtf" />

    <Feature Id="MainApplication" Title="NAPS2" Level="1">
      <ComponentRef Id="Exec" />
      <ComponentRef Id="ApplicationShortcut" />
      <ComponentGroupRef Id="LangComponents" />
    </Feature>

    <ComponentGroup Id="LangComponents">
      <ComponentRef Id="LangComponent_bg" />
      <ComponentRef Id="LangComponent_ca" />
      <ComponentRef Id="LangComponent_cs" />
      <ComponentRef Id="LangComponent_da" />
      <ComponentRef Id="LangComponent_de" />
      <ComponentRef Id="LangComponent_es" />
      <ComponentRef Id="LangComponent_fr" />
      <ComponentRef Id="LangComponent_he" />
      <ComponentRef Id="LangComponent_hr" />
      <ComponentRef Id="LangComponent_hu" />
      <ComponentRef Id="LangComponent_it" />
      <ComponentRef Id="LangComponent_nl" />
      <ComponentRef Id="LangComponent_pl" />
      <ComponentRef Id="LangComponent_pt_BR" />
      <ComponentRef Id="LangComponent_pt_PT" />
      <ComponentRef Id="LangComponent_ro" />
      <ComponentRef Id="LangComponent_ru" />
      <ComponentRef Id="LangComponent_uk" />
    </ComponentGroup>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="NAPS2" />
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ProgramMenuDir" Name="NAPS2" />
      </Directory>
    </Directory>

    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="Exec" Guid="3ED24800-E1D9-4D64-A106-6DC3597D9266">
        <!-- EXEs -->
        <File Source="..\NAPS2\bin\InstallerMSI\NAPS2.exe" />
        <File Source="..\NAPS2.Console\bin\InstallerMSI\NAPS2.Console.exe" />
        <!-- Dependencies -->
        <File Source="..\NAPS2\bin\InstallerMSI\NAPS2.Core.dll" />
        <File Source="..\NAPS2\bin\InstallerMSI\PdfSharp.dll" />
        <File Source="..\NAPS2\bin\InstallerMSI\Interop.WIA.dll" />
        <File Source="..\NAPS2\bin\InstallerMSI\Ninject.dll" />
        <File Source="..\NAPS2\bin\InstallerMSI\NLog.dll" />
        <File Source="..\NAPS2.Core\Resources\scanner-app.ico" />
        <File Source="..\NAPS2\Setup\lib\wiaaut.dll" />
        <File Source="..\NAPS2.Console\bin\InstallerMSI\CommandLine.dll" />
        <!-- Configuration -->
        <File Source="..\NAPS2\appsettings.xml" />
        <!-- License -->
        <File Source="..\NAPS2\Setup\license.txt" />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="INSTALLFOLDER">
      <Directory Id="LangFolder_bg" Name="bg">
        <Component Id="LangComponent_bg">
          <File Source="..\NAPS2\bin\InstallerMSI\bg\NAPS2.Core.resources.dll" Id="LangFile_bg" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_ca" Name="ca">
        <Component Id="LangComponent_ca">
          <File Source="..\NAPS2\bin\InstallerMSI\ca\NAPS2.Core.resources.dll" Id="LangFile_ca" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_cs" Name="cs">
        <Component Id="LangComponent_cs">
          <File Source="..\NAPS2\bin\InstallerMSI\cs\NAPS2.Core.resources.dll" Id="LangFile_cs" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_da" Name="da">
        <Component Id="LangComponent_da">
          <File Source="..\NAPS2\bin\InstallerMSI\da\NAPS2.Core.resources.dll" Id="LangFile_da" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_de" Name="de">
        <Component Id="LangComponent_de">
          <File Source="..\NAPS2\bin\InstallerMSI\de\NAPS2.Core.resources.dll" Id="LangFile_de" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_es" Name="es">
        <Component Id="LangComponent_es">
          <File Source="..\NAPS2\bin\InstallerMSI\es\NAPS2.Core.resources.dll" Id="LangFile_es" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_fr" Name="fr">
        <Component Id="LangComponent_fr">
          <File Source="..\NAPS2\bin\InstallerMSI\fr\NAPS2.Core.resources.dll" Id="LangFile_fr" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_he" Name="he">
        <Component Id="LangComponent_he">
          <File Source="..\NAPS2\bin\InstallerMSI\he\NAPS2.Core.resources.dll" Id="LangFile_he" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_hr" Name="hr">
        <Component Id="LangComponent_hr">
          <File Source="..\NAPS2\bin\InstallerMSI\hr\NAPS2.Core.resources.dll" Id="LangFile_hr" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_hu" Name="hu">
        <Component Id="LangComponent_hu">
          <File Source="..\NAPS2\bin\InstallerMSI\hu\NAPS2.Core.resources.dll" Id="LangFile_hu" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_it" Name="it">
        <Component Id="LangComponent_it">
          <File Source="..\NAPS2\bin\InstallerMSI\it\NAPS2.Core.resources.dll" Id="LangFile_it" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_nl" Name="nl">
        <Component Id="LangComponent_nl">
          <File Source="..\NAPS2\bin\InstallerMSI\nl\NAPS2.Core.resources.dll" Id="LangFile_nl" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_pl" Name="pl">
        <Component Id="LangComponent_pl">
          <File Source="..\NAPS2\bin\InstallerMSI\pl\NAPS2.Core.resources.dll" Id="LangFile_pl" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_pt_BR" Name="pt-BR">
        <Component Id="LangComponent_pt_BR">
          <File Source="..\NAPS2\bin\InstallerMSI\pt-BR\NAPS2.Core.resources.dll" Id="LangFile_pt_BR" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_pt_PT" Name="pt-PT">
        <Component Id="LangComponent_pt_PT">
          <File Source="..\NAPS2\bin\InstallerMSI\pt-PT\NAPS2.Core.resources.dll" Id="LangFile_pt_PT" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_ro" Name="ro">
        <Component Id="LangComponent_ro">
          <File Source="..\NAPS2\bin\InstallerMSI\ro\NAPS2.Core.resources.dll" Id="LangFile_ro" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_ru" Name="ru">
        <Component Id="LangComponent_ru">
          <File Source="..\NAPS2\bin\InstallerMSI\ru\NAPS2.Core.resources.dll" Id="LangFile_ru" />
        </Component>
      </Directory>
      <Directory Id="LangFolder_uk" Name="uk">
        <Component Id="LangComponent_uk">
          <File Source="..\NAPS2\bin\InstallerMSI\uk\NAPS2.Core.resources.dll" Id="LangFile_uk" />
        </Component>
      </Directory>
    </DirectoryRef>

    <DirectoryRef Id="ProgramMenuDir">
      <Component Id="ApplicationShortcut" Guid="F5122C0C-7DCA-4D0A-AF70-C87C972267AB">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="NAPS2"
                  Description="Not Another PDF Scanner 2"
                  Target="[INSTALLFOLDER]NAPS2.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="ProgramMenuDir" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\Microsoft\NAPS2" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

  </Product>
</Wix>
